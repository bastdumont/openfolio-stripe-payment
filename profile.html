<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Votre Profil - OpenFolio</title>
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/assets/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/assets/favicon-16x16.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/assets/apple-touch-icon.png"
    />
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <!-- Icons: Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      referrerpolicy="no-referrer"
    />
    <style>
      :root {
        /* Balder App Brand Colors - Enhanced */
        --color-primary: #ffb500;
        --color-primary-hover: #e5a200;
        --color-primary-active: #cc9100;
        --color-primary-light: #ffc932;
        --color-primary-soft: #fff4d6;
        --color-dark: #1a1a1a;
        --color-text: #1f2937;
        --color-text-secondary: #4b5563;
        --color-text-muted: #6b7280;
        --color-border: #e5e7eb;
        --color-border-light: #f3f4f6;
        --color-surface: #ffffff;
        --color-background: #fafbfc;
        --color-background-alt: #f8f9fa;

        /* Premium shadow system */
        --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.05);
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
        --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.05),
          0 2px 4px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1),
          0 4px 6px rgba(0, 0, 0, 0.05);
        --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1),
          0 8px 10px rgba(0, 0, 0, 0.04);
        --shadow-2xl: 0 25px 50px rgba(0, 0, 0, 0.15);

        /* Modern border radius scale */
        --radius-xs: 4px;
        --radius-sm: 6px;
        --radius: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 20px;
        --radius-2xl: 24px;
        --radius-full: 9999px;

        /* Typography system */
        --font-weight-regular: 400;
        --font-weight-medium: 500;
        --font-weight-semibold: 600;
        --font-weight-bold: 700;
        --font-weight-extrabold: 800;

        /* Fluid spacing scale */
        --space-1: 0.25rem;
        --space-1-5: 0.375rem;
        --space-2: 0.5rem;
        --space-2-5: 0.625rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        --space-10: 2.5rem;
        --space-12: 3rem;
        --space-14: 3.5rem;
        --space-16: 4rem;

        /* Animation system */
        --duration-200: 200ms;
        --duration-300: 300ms;
        --duration-500: 500ms;
        --ease-out: cubic-bezier(0, 0, 0.2, 1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Heebo', -apple-system, BlinkMacSystemFont, 'Segoe UI',
          Roboto, 'Helvetica Neue', Arial, sans-serif;
        font-weight: var(--font-weight-regular);
        background: var(--color-background);
        min-height: 100vh;
        padding: var(--space-6);
        color: var(--color-text);
        line-height: 1.7;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 0 var(--space-4);
      }

      /* Logo */
      .logo-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        margin-bottom: var(--space-6);
      }

      .logo-svg {
        width: 64px;
        height: 64px;
      }

      .logo-text {
        font-size: 1.5rem;
        font-weight: var(--font-weight-bold);
        color: var(--color-dark);
        letter-spacing: -0.02em;
      }

      /* Header */
      .header {
        text-align: center;
        margin-bottom: var(--space-8);
      }

      .header h1 {
        font-size: clamp(1.25rem, 3vw, 1.5rem);
        font-weight: var(--font-weight-semibold);
        color: var(--color-text-secondary);
        margin-bottom: var(--space-1);
      }

      .header p {
        font-size: 0.875rem;
        color: var(--color-text-muted);
      }

      /* Main Card */
      .main-card {
        background: var(--color-surface);
        border-radius: var(--radius-2xl);
        box-shadow: var(--shadow-2xl);
        padding: var(--space-6) var(--space-8);
        min-height: 500px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        border: 1px solid var(--color-border);
        position: relative;
        overflow: hidden;
      }

      /* Step Indicator */
      .step-indicator {
        margin-bottom: var(--space-8);
        position: relative;
      }

      .step-indicator-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.75rem;
        font-weight: var(--font-weight-bold);
        color: var(--color-text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: var(--space-2);
        padding-left: var(--space-8);
      }

      .back-button {
        position: absolute;
        top: -4px;
        left: -8px;
        padding: var(--space-2);
        color: var(--color-text-muted);
        background: transparent;
        border: none;
        border-radius: var(--radius-full);
        cursor: pointer;
        transition: all var(--duration-300) var(--ease-out);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .back-button:hover {
        color: var(--color-dark);
        background: var(--color-background-alt);
      }

      .progress-bar {
        height: 8px;
        width: 100%;
        background: var(--color-background-alt);
        border-radius: var(--radius-full);
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          135deg,
          var(--color-primary) 0%,
          var(--color-primary-light) 100%
        );
        transition: width var(--duration-500) var(--ease-out);
      }

      .loading {
        display: inline-block;
        width: 14px;
        height: 14px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top-color: var(--color-surface);
        border-radius: 50%;
        animation: spin 0.6s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Step Content */
      .step-content {
        display: none;
        animation: fadeIn 0.4s ease-out forwards;
      }

      .step-content.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Step Header */
      .step-header {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        margin-bottom: var(--space-6);
      }

      .step-icon {
        background: var(--color-dark);
        padding: var(--space-2-5);
        border-radius: var(--radius-lg);
        color: var(--color-primary);
        box-shadow: var(--shadow-sm);
      }

      .step-title {
        font-size: 1.25rem;
        font-weight: var(--font-weight-bold);
        color: var(--color-dark);
      }

      /* Selection Cards */
      .selection-grid {
        display: grid;
        gap: var(--space-3);
        margin-bottom: var(--space-8);
      }

      .selection-grid.cols-2 {
        grid-template-columns: repeat(2, 1fr);
      }

      .selection-grid.cols-3 {
        grid-template-columns: repeat(3, 1fr);
      }

      .selection-grid.cols-4 {
        grid-template-columns: repeat(4, 1fr);
      }

      .selection-card {
        position: relative;
        padding: var(--space-4) var(--space-6);
        border-radius: var(--radius-xl);
        border: 2px solid var(--color-border);
        cursor: pointer;
        transition: all var(--duration-300) var(--ease-out);
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: var(--space-3);
        background: var(--color-surface);
      }

      .selection-card:hover {
        border-color: var(--color-primary);
        box-shadow: var(--shadow-md);
      }

      .selection-card.selected {
        border-color: var(--color-primary);
        background: var(--color-primary-soft);
        box-shadow: var(--shadow-sm);
        transform: translateY(-2px);
      }

      .selection-card.selected::after {
        content: '✓';
        position: absolute;
        top: var(--space-3);
        right: var(--space-3);
        background: var(--color-primary);
        color: var(--color-dark);
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: var(--font-weight-bold);
        box-shadow: var(--shadow-md);
      }

      .selection-card-icon {
        font-size: 2rem;
        color: var(--color-text-muted);
        transition: color var(--duration-300) var(--ease-out);
      }

      .selection-card:hover .selection-card-icon,
      .selection-card.selected .selection-card-icon {
        color: var(--color-primary);
      }

      .selection-card-title {
        font-weight: var(--font-weight-semibold);
        color: var(--color-text);
      }

      .selection-card.selected .selection-card-title {
        color: var(--color-dark);
      }

      .selection-card-description {
        font-size: 0.875rem;
        color: var(--color-text-muted);
        margin-top: var(--space-1);
      }

      /* Question Labels */
      .question-label {
        display: block;
        font-size: 0.875rem;
        font-weight: var(--font-weight-semibold);
        color: var(--color-text);
        margin-bottom: var(--space-2);
      }

      /* Button Groups */
      .button-group {
        display: flex;
        gap: var(--space-3);
        flex-wrap: wrap;
      }

      .button-group.vertical {
        flex-direction: column;
      }

      .button-option {
        flex: 1;
        padding: var(--space-3) var(--space-4);
        border-radius: var(--radius-lg);
        font-size: 0.875rem;
        font-weight: var(--font-weight-medium);
        transition: all var(--duration-300) var(--ease-out);
        border: 1px solid var(--color-border);
        background: var(--color-surface);
        color: var(--color-text-secondary);
        cursor: pointer;
        min-height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .button-option:hover {
        border-color: var(--color-primary);
        color: var(--color-dark);
      }

      .button-option.selected {
        background: var(--color-dark);
        border-color: var(--color-dark);
        color: var(--color-surface);
        box-shadow: var(--shadow-md);
        transform: scale(1.02);
      }

      /* Info Boxes */
      .info-box {
        padding: var(--space-5);
        background: var(--color-background-alt);
        border-radius: var(--radius-xl);
        border: 1px solid var(--color-border);
        margin-bottom: var(--space-6);
      }

      /* Form Inputs */
      .input-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-4);
      }

      .input-group {
        margin-bottom: var(--space-4);
      }

      .input-label {
        display: block;
        font-size: 0.75rem;
        font-weight: var(--font-weight-bold);
        text-transform: uppercase;
        color: var(--color-text-muted);
        margin-bottom: var(--space-1-5);
        margin-left: var(--space-1);
        letter-spacing: 0.05em;
      }

      .input-wrapper {
        position: relative;
      }

      .input-prefix {
        position: absolute;
        left: var(--space-3);
        top: 50%;
        transform: translateY(-50%);
        color: var(--color-text-muted);
        font-weight: var(--font-weight-bold);
      }

      .input-wrapper:focus-within .input-prefix {
        color: var(--color-primary);
      }

      .form-input,
      .form-select {
        width: 100%;
        padding: var(--space-3) var(--space-4);
        padding-left: var(--space-14);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        font-size: 1rem;
        font-weight: var(--font-weight-medium);
        transition: all var(--duration-300) var(--ease-out);
        background: var(--color-surface);
        color: var(--color-text);
        font-family: 'Heebo', sans-serif;
        min-height: 48px;
      }

      .form-input:focus,
      .form-select:focus {
        outline: none;
        border-color: var(--color-primary);
        box-shadow: 0 0 0 4px var(--color-primary-soft);
      }

      .form-select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%234b5563' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right var(--space-3) center;
        padding-right: var(--space-10);
      }

      .input-icon {
        position: absolute;
        left: var(--space-3);
        top: 50%;
        transform: translateY(-50%);
        color: var(--color-text-muted);
      }

      .input-wrapper:focus-within .input-icon {
        color: var(--color-primary);
      }

      /* Summary Step */
      .summary-container {
        text-align: center;
        padding: var(--space-8) 0;
      }

      .summary-icon {
        width: 80px;
        height: 80px;
        background: var(--color-primary-soft);
        color: var(--color-primary);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto var(--space-6);
        box-shadow: var(--shadow-sm);
      }

      .summary-icon i {
        font-size: 2.5rem;
      }

      .summary-title {
        font-size: 1.5rem;
        font-weight: var(--font-weight-bold);
        color: var(--color-dark);
        margin-bottom: var(--space-2);
      }

      .summary-description {
        color: var(--color-text-muted);
        max-width: 28rem;
        margin: 0 auto var(--space-8);
      }

      .summary-box {
        background: var(--color-background-alt);
        padding: var(--space-6);
        border-radius: var(--radius-xl);
        text-align: left;
        max-width: 24rem;
        margin: 0 auto var(--space-8);
        border: 1px solid var(--color-border);
      }

      .summary-box-header {
        font-weight: var(--font-weight-bold);
        font-size: 0.75rem;
        color: var(--color-text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: var(--space-4);
        padding-bottom: var(--space-2);
        border-bottom: 1px solid var(--color-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .summary-box-header .badge {
        color: var(--color-primary);
        font-size: 0.625rem;
      }

      .summary-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-3);
        font-size: 0.875rem;
      }

      .summary-item-label {
        color: var(--color-text-muted);
      }

      .summary-item-value {
        font-weight: var(--font-weight-bold);
        color: var(--color-dark);
        background: var(--color-surface);
        padding: var(--space-1) var(--space-2);
        border-radius: var(--radius-sm);
        border: 1px solid var(--color-border);
        box-shadow: var(--shadow-xs);
      }

      /* Navigation Footer */
      .nav-footer {
        margin-top: var(--space-8);
        padding-top: var(--space-6);
        border-top: 1px solid var(--color-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .btn {
        padding: var(--space-3) var(--space-6);
        border-radius: var(--radius-xl);
        font-weight: var(--font-weight-medium);
        font-size: 0.875rem;
        cursor: pointer;
        transition: all var(--duration-300) var(--ease-out);
        border: none;
        font-family: 'Heebo', sans-serif;
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
      }

      .btn-secondary {
        color: var(--color-text-secondary);
        background: transparent;
      }

      .btn-secondary:hover:not(:disabled) {
        background: var(--color-background-alt);
        color: var(--color-dark);
      }

      .btn-secondary:disabled {
        color: var(--color-border);
        cursor: not-allowed;
      }

      .btn-primary {
        background: var(--color-dark);
        color: var(--color-surface);
        box-shadow: var(--shadow-lg);
      }

      .btn-primary:hover {
        background: #0f1419;
        box-shadow: var(--shadow-xl);
        transform: translateY(-2px);
      }

      .btn-submit {
        background: var(--color-dark);
        color: var(--color-surface);
        padding: var(--space-3) var(--space-8);
        box-shadow: var(--shadow-md);
      }

      .btn-submit:hover {
        background: #0f1419;
        box-shadow: var(--shadow-lg);
        transform: translateY(-1px);
      }

      /* Responsive */
      @media (min-width: 640px) {
        .selection-grid.cols-2 {
          grid-template-columns: repeat(2, 1fr);
        }
        .selection-grid.cols-4 {
          grid-template-columns: repeat(4, 1fr);
        }
      }

      @media (max-width: 768px) {
        body {
          padding: var(--space-4);
        }

        .main-card {
          padding: var(--space-6);
        }

        .selection-grid.cols-2,
        .selection-grid.cols-3,
        .selection-grid.cols-4 {
          grid-template-columns: 1fr;
        }

        .button-group {
          flex-direction: column;
        }

        .button-option {
          width: 100%;
        }

        .input-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 480px) {
        .step-indicator-header {
          padding-left: var(--space-6);
        }

        .back-button {
          left: -4px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Logo -->
      <div class="logo-container">
        <svg
          class="logo-svg"
          viewBox="0 0 100 100"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <!-- Yellow Folder Body -->
          <path
            d="M10 20C10 14.4772 14.4772 10 20 10H45L55 20H90C95.5228 20 100 24.4772 100 30V80C100 85.5228 95.5228 90 90 90H20C14.4772 90 10 85.5228 10 80V20Z"
            fill="#FBBF24"
          />
          <!-- Dark Graph Flap -->
          <path
            d="M55 20L55 80C55 85.5228 59.4772 90 65 90H90C95.5228 90 100 85.5228 100 80V30C100 24.4772 95.5228 20 90 20H55Z"
            fill="#1E293B"
          />
          <!-- Graph Lines -->
          <path
            d="M68 65L75 55L82 62L90 45"
            stroke="white"
            stroke-width="4"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <rect
            x="65"
            y="70"
            width="6"
            height="10"
            rx="1"
            fill="white"
            fill-opacity="0.8"
          />
          <rect
            x="75"
            y="60"
            width="6"
            height="20"
            rx="1"
            fill="white"
            fill-opacity="0.8"
          />
          <rect
            x="85"
            y="48"
            width="6"
            height="32"
            rx="1"
            fill="white"
            fill-opacity="0.8"
          />
          <!-- Folder Lines -->
          <rect
            x="20"
            y="35"
            width="25"
            height="4"
            rx="2"
            fill="#1E293B"
            fill-opacity="0.8"
          />
          <rect
            x="20"
            y="45"
            width="25"
            height="4"
            rx="2"
            fill="#1E293B"
            fill-opacity="0.8"
          />
          <rect
            x="20"
            y="55"
            width="15"
            height="4"
            rx="2"
            fill="#1E293B"
            fill-opacity="0.8"
          />
        </svg>
        <span class="logo-text">openfolio</span>
      </div>

      <!-- Header -->
      <div class="header">
        <h1>Votre Profil</h1>
        <p id="step-description">Étape 1 : Configuration de votre stratégie</p>
      </div>

      <!-- Main Card -->
      <div class="main-card">
        <!-- Step Indicator -->
        <div class="step-indicator">
          <button
            class="back-button"
            id="back-button"
            style="display: none"
            title="Retour"
          >
            <i class="fas fa-chevron-left"></i>
          </button>
          <div class="step-indicator-header">
            <span>Progression</span>
            <span id="step-counter">Étape 1 / 5</span>
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill"
              id="progress-fill"
              style="width: 20%"
            ></div>
          </div>
        </div>

        <!-- Step 1: Connaissances -->
        <div class="step-content active" id="step-1">
          <div class="step-header">
            <div class="step-icon">
              <i class="fas fa-graduation-cap"></i>
            </div>
            <h2 class="step-title">Vos Connaissances</h2>
          </div>

          <div style="margin-bottom: var(--space-8)">
            <label class="question-label">
              1. Quelles connaissances avez-vous des marchés financiers (bourse,
              trading...) ?
            </label>
            <div class="selection-grid cols-4" id="market-knowledge-grid">
              <div
                class="selection-card"
                data-value="Aucunes"
                data-field="marketKnowledge"
              >
                <div class="selection-card-title">Aucunes</div>
              </div>
              <div
                class="selection-card"
                data-value="Peu"
                data-field="marketKnowledge"
              >
                <div class="selection-card-title">Peu</div>
              </div>
              <div
                class="selection-card"
                data-value="Bonnes"
                data-field="marketKnowledge"
              >
                <div class="selection-card-title">Bonnes</div>
              </div>
              <div
                class="selection-card"
                data-value="Excellentes"
                data-field="marketKnowledge"
              >
                <div class="selection-card-title">Excellentes</div>
              </div>
            </div>
          </div>

          <div>
            <label class="question-label">
              2. Et concernant les instruments financiers complexes (Actions,
              Obligations, ETF...) ?
            </label>
            <div class="selection-grid cols-4" id="instrument-knowledge-grid">
              <div
                class="selection-card"
                data-value="Aucunes"
                data-field="instrumentKnowledge"
              >
                <div class="selection-card-title">Aucunes</div>
              </div>
              <div
                class="selection-card"
                data-value="Peu"
                data-field="instrumentKnowledge"
              >
                <div class="selection-card-title">Peu</div>
              </div>
              <div
                class="selection-card"
                data-value="Bonnes"
                data-field="instrumentKnowledge"
              >
                <div class="selection-card-title">Bonnes</div>
              </div>
              <div
                class="selection-card"
                data-value="Excellentes"
                data-field="instrumentKnowledge"
              >
                <div class="selection-card-title">Excellentes</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 2: Risque -->
        <div class="step-content" id="step-2">
          <div class="step-header">
            <div class="step-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <h2 class="step-title">Tolérance au Risque</h2>
          </div>

          <div style="margin-bottom: var(--space-8)">
            <label class="question-label">
              3. Si votre portefeuille baisse de -20% en une journée, comment
              réagissez-vous ?
            </label>
            <div class="selection-grid cols-3" id="fluctuation-tolerance-grid">
              <div
                class="selection-card"
                data-value="Peu"
                data-field="fluctuationTolerance"
              >
                <i class="fas fa-exclamation-triangle selection-card-icon"></i>
                <div>
                  <div class="selection-card-title">Inquiet</div>
                  <div class="selection-card-description">Peu de tolérance</div>
                </div>
              </div>
              <div
                class="selection-card"
                data-value="Bonne"
                data-field="fluctuationTolerance"
              >
                <i class="fas fa-chart-line selection-card-icon"></i>
                <div>
                  <div class="selection-card-title">Acceptable</div>
                  <div class="selection-card-description">C'est le jeu</div>
                </div>
              </div>
              <div
                class="selection-card"
                data-value="Aucuns soucis"
                data-field="fluctuationTolerance"
              >
                <i class="fas fa-briefcase selection-card-icon"></i>
                <div>
                  <div class="selection-card-title">Serein</div>
                  <div class="selection-card-description">Aucun soucis</div>
                </div>
              </div>
            </div>
          </div>

          <div>
            <label class="question-label">
              4. Quelle perte annuelle maximale êtes-vous prêt à accepter pour
              viser un meilleur rendement ?
            </label>
            <div class="selection-grid cols-3" id="max-annual-loss-grid">
              <div
                class="selection-card"
                data-value="10%"
                data-field="maxAnnualLoss"
              >
                <div class="selection-card-title">Max 10%</div>
                <div class="selection-card-description">Prudent</div>
              </div>
              <div
                class="selection-card"
                data-value="20%"
                data-field="maxAnnualLoss"
              >
                <div class="selection-card-title">Max 20%</div>
                <div class="selection-card-description">Équilibré</div>
              </div>
              <div
                class="selection-card"
                data-value="50%"
                data-field="maxAnnualLoss"
              >
                <div class="selection-card-title">Max 50%</div>
                <div class="selection-card-description">Dynamique</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 3: Objectifs -->
        <div class="step-content" id="step-3">
          <div class="step-header">
            <div class="step-icon">
              <i class="fas fa-bullseye"></i>
            </div>
            <h2 class="step-title">Vos Objectifs</h2>
          </div>

          <div>
            <label class="question-label">
              5. Quel est l'objectif principal de cet investissement ?
            </label>
            <div class="selection-grid" id="investment-goal-grid">
              <div
                class="selection-card"
                data-value="Salaire"
                data-field="investmentGoal"
              >
                <i class="fas fa-wallet selection-card-icon"></i>
                <div>
                  <div class="selection-card-title">Complément de Revenu</div>
                  <div class="selection-card-description">
                    Compléter votre salaire actuel
                  </div>
                </div>
              </div>
              <div
                class="selection-card"
                data-value="Projet"
                data-field="investmentGoal"
              >
                <i class="fas fa-piggy-bank selection-card-icon"></i>
                <div>
                  <div class="selection-card-title">Projet Futur</div>
                  <div class="selection-card-description">
                    Constituer un capital pour un projet (immobilier, etc.)
                  </div>
                </div>
              </div>
              <div
                class="selection-card"
                data-value="Retraite"
                data-field="investmentGoal"
              >
                <i class="fas fa-briefcase selection-card-icon"></i>
                <div>
                  <div class="selection-card-title">Retraite</div>
                  <div class="selection-card-description">
                    Préparer l'avenir / Compléter 2ème pilier
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 4: Situation Financière -->
        <div class="step-content" id="step-4">
          <div class="step-header">
            <div class="step-icon">
              <i class="fas fa-wallet"></i>
            </div>
            <h2 class="step-title">Situation & Logistique</h2>
          </div>

          <div>
            <div class="info-box">
              <label class="question-label">
                En cas d'imprévus, aurez-vous besoin de récupérer ce capital
                rapidement ?
              </label>
              <div class="button-group">
                <button
                  class="button-option"
                  data-value="Oui"
                  data-field="liquidityNeed"
                >
                  Oui
                </button>
                <button
                  class="button-option"
                  data-value="Non"
                  data-field="liquidityNeed"
                >
                  Non
                </button>
                <button
                  class="button-option"
                  data-value="En partie"
                  data-field="liquidityNeed"
                >
                  En partie
                </button>
              </div>
            </div>

            <div class="info-box">
              <label class="question-label">
                Comptez-vous investir régulièrement (épargne mensuelle) ?
              </label>
              <div class="button-group">
                <button
                  class="button-option"
                  data-value="Oui"
                  data-field="regularInvestment"
                >
                  Oui
                </button>
                <button
                  class="button-option"
                  data-value="Non"
                  data-field="regularInvestment"
                >
                  Non
                </button>
              </div>
            </div>

            <div class="input-grid">
              <div class="input-group">
                <label class="input-label">Montant Initial</label>
                <div class="input-wrapper">
                  <span class="input-prefix">CHF</span>
                  <input
                    type="number"
                    class="form-input"
                    id="initial-amount"
                    placeholder="0.00"
                  />
                </div>
              </div>
              <div class="input-group">
                <label class="input-label">Horizon de temps</label>
                <div class="input-wrapper">
                  <i class="fas fa-clock input-icon"></i>
                  <select class="form-select" id="time-horizon">
                    <option value="">Sélectionner...</option>
                    <option value="court">Court terme (1-3 ans)</option>
                    <option value="moyen">Moyen terme (3-7 ans)</option>
                    <option value="long">Long terme (8+ ans)</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 5: Summary -->
        <div class="step-content" id="step-5">
          <div class="summary-container">
            <div class="summary-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <h2 class="summary-title">Profil Complété !</h2>
            <p class="summary-description">
              Merci d'avoir répondu à toutes les questions. Votre profil de
              risque OpenFolio a été établi.
            </p>

            <div class="summary-box">
              <div class="summary-box-header">
                <span>Résumé</span>
                <span class="badge">OPENFOLIO</span>
              </div>
              <div class="summary-item">
                <span class="summary-item-label">Risque Max</span>
                <span class="summary-item-value" id="summary-max-loss">-</span>
              </div>
              <div class="summary-item">
                <span class="summary-item-label">Tolérance</span>
                <span class="summary-item-value" id="summary-tolerance">-</span>
              </div>
              <div class="summary-item">
                <span class="summary-item-label">Objectif</span>
                <span class="summary-item-value" id="summary-goal">-</span>
              </div>
            </div>

            <!-- Optional contact information -->
            <div
              class="info-box"
              style="max-width: 24rem; margin: 0 auto var(--space-6)"
            >
              <label class="input-label" style="margin-bottom: var(--space-2)"
                >Informations de contact (optionnel)</label
              >
              <div class="input-group" style="margin-bottom: var(--space-3)">
                <div class="input-wrapper">
                  <i class="fas fa-envelope input-icon"></i>
                  <input
                    type="email"
                    class="form-input"
                    id="user-email"
                    placeholder="votre@email.com"
                  />
                </div>
              </div>
              <div class="input-group">
                <div class="input-wrapper">
                  <i class="fas fa-user input-icon"></i>
                  <input
                    type="text"
                    class="form-input"
                    id="user-name"
                    placeholder="Votre nom"
                  />
                </div>
              </div>
            </div>

            <!-- Success/Error Message -->
            <div
              id="submission-message"
              style="display: none; margin-bottom: var(--space-4)"
            >
              <div
                id="message-content"
                style="
                  padding: var(--space-4);
                  border-radius: var(--radius-lg);
                  text-align: center;
                "
              ></div>
            </div>

            <div
              style="
                display: flex;
                gap: var(--space-4);
                justify-content: center;
              "
            >
              <button class="btn btn-secondary" id="edit-button">
                Modifier
              </button>
              <button class="btn btn-submit" id="submit-button">
                Soumettre le Dossier
              </button>
            </div>
          </div>
        </div>

        <!-- Navigation Footer -->
        <div class="nav-footer" id="nav-footer" style="display: none">
          <button class="btn btn-secondary" id="prev-button" disabled>
            <i class="fas fa-arrow-left"></i>
            Retour
          </button>
          <button class="btn btn-primary" id="next-button">
            Continuer
            <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
    </div>

    <script>
      // Application state
      let currentStep = 1;
      const totalSteps = 5;
      const formData = {
        marketKnowledge: '',
        instrumentKnowledge: '',
        fluctuationTolerance: '',
        maxAnnualLoss: '',
        investmentGoal: '',
        liquidityNeed: '',
        regularInvestment: '',
        initialAmount: '',
        timeHorizon: '',
      };

      // DOM elements
      const stepDescription = document.getElementById('step-description');
      const stepCounter = document.getElementById('step-counter');
      const progressFill = document.getElementById('progress-fill');
      const backButton = document.getElementById('back-button');
      const navFooter = document.getElementById('nav-footer');
      const prevButton = document.getElementById('prev-button');
      const nextButton = document.getElementById('next-button');
      const editButton = document.getElementById('edit-button');
      const submitButton = document.getElementById('submit-button');

      // Initialize
      function init() {
        updateStepDisplay();
        setupEventListeners();
      }

      // Setup event listeners
      function setupEventListeners() {
        // Selection cards
        document.querySelectorAll('.selection-card').forEach((card) => {
          card.addEventListener('click', () => {
            const value = card.dataset.value;
            const field = card.dataset.field;
            if (value && field) {
              selectOption(field, value);
            }
          });
        });

        // Button options
        document.querySelectorAll('.button-option').forEach((button) => {
          button.addEventListener('click', () => {
            const value = button.dataset.value;
            const field = button.dataset.field;
            if (value && field) {
              selectButtonOption(field, value);
            }
          });
        });

        // Form inputs
        document
          .getElementById('initial-amount')
          .addEventListener('input', (e) => {
            formData.initialAmount = e.target.value;
          });

        document
          .getElementById('time-horizon')
          .addEventListener('change', (e) => {
            formData.timeHorizon = e.target.value;
          });

        // Navigation
        backButton.addEventListener('click', prevStep);
        prevButton.addEventListener('click', prevStep);
        nextButton.addEventListener('click', nextStep);
        editButton.addEventListener('click', () => {
          goToStep(4);
        });
        submitButton.addEventListener('click', async () => {
          // Get optional contact information
          const userEmail = document.getElementById('user-email').value.trim();
          const userName = document.getElementById('user-name').value.trim();

          // Prepare submission data
          const submissionData = {
            ...formData,
            email: userEmail || '',
            name: userName || '',
          };

          // Disable button and show loading state
          submitButton.disabled = true;
          const originalText = submitButton.innerHTML;
          submitButton.innerHTML =
            '<span class="loading"></span>Envoi en cours...';

          // Hide previous messages
          const messageDiv = document.getElementById('submission-message');
          const messageContent = document.getElementById('message-content');
          messageDiv.style.display = 'none';

          try {
            const response = await fetch('/submit-profile', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                Accept: 'application/json',
              },
              body: JSON.stringify(submissionData),
            });

            const contentType = response.headers.get('content-type') || '';
            let data;

            if (contentType.includes('application/json')) {
              data = await response.json();
            } else {
              const text = await response.text();
              throw new Error(
                `Unexpected server response. Status ${
                  response.status
                }. ${text.substring(0, 200)}`
              );
            }

            if (response.ok && data.success) {
              // Show success message
              messageContent.innerHTML = `
                <div style="color: #059669; background: #d1fae5; padding: var(--space-4); border-radius: var(--radius-lg); border: 1px solid #10b981;">
                  <i class="fas fa-check-circle" style="margin-right: var(--space-2);"></i>
                  <strong>Profil soumis avec succès !</strong><br>
                  <span style="font-size: 0.875rem;">Merci pour votre participation.</span>
    </div>
              `;
              messageDiv.style.display = 'block';

              // Reset form after 3 seconds (optional)
              setTimeout(() => {
                // Could redirect or reset form here if needed
              }, 3000);
            } else {
              throw new Error(
                (data && data.error && data.error.message) ||
                  `Request failed with status ${response.status}`
              );
            }
          } catch (error) {
            // Show error message
            messageContent.innerHTML = `
              <div style="color: #dc2626; background: #fee2e2; padding: var(--space-4); border-radius: var(--radius-lg); border: 1px solid #ef4444;">
                <i class="fas fa-exclamation-circle" style="margin-right: var(--space-2);"></i>
                <strong>Erreur lors de l'envoi</strong><br>
                <span style="font-size: 0.875rem;">${error.message}</span>
              </div>
            `;
            messageDiv.style.display = 'block';
            console.error('Profile submission error:', error);
          } finally {
            // Re-enable button
            submitButton.disabled = false;
            submitButton.innerHTML = originalText;
          }
        });
      }

      // Select option in selection cards
      function selectOption(field, value) {
        formData[field] = value;

        // Update UI
        document.querySelectorAll(`[data-field="${field}"]`).forEach((card) => {
          card.classList.remove('selected');
        });

        const selectedCard = document.querySelector(
          `[data-field="${field}"][data-value="${value}"]`
        );
        if (selectedCard) {
          selectedCard.classList.add('selected');
        }
      }

      // Select button option
      function selectButtonOption(field, value) {
        formData[field] = value;

        // Update UI
        document
          .querySelectorAll(`[data-field="${field}"]`)
          .forEach((button) => {
            button.classList.remove('selected');
          });

        const selectedButton = document.querySelector(
          `[data-field="${field}"][data-value="${value}"]`
        );
        if (selectedButton) {
          selectedButton.classList.add('selected');
        }
      }

      // Update step display
      function updateStepDisplay() {
        // Update step counter
        stepCounter.textContent = `Étape ${currentStep} / ${totalSteps}`;
        stepDescription.textContent = `Étape ${currentStep} : Configuration de votre stratégie`;

        // Update progress bar
        const progress = (currentStep / totalSteps) * 100;
        progressFill.style.width = `${progress}%`;

        // Show/hide steps
        for (let i = 1; i <= totalSteps; i++) {
          const stepEl = document.getElementById(`step-${i}`);
          if (stepEl) {
            stepEl.classList.toggle('active', i === currentStep);
          }
        }

        // Show/hide navigation
        if (currentStep < totalSteps) {
          navFooter.style.display = 'flex';
          backButton.style.display = currentStep > 1 ? 'flex' : 'none';
          prevButton.disabled = currentStep === 1;
        } else {
          navFooter.style.display = 'none';
          backButton.style.display = 'none';
        }

        // Update summary if on step 5
        if (currentStep === 5) {
          updateSummary();
        }

        // Scroll to top
        window.scrollTo(0, 0);
      }

      // Update summary
      function updateSummary() {
        document.getElementById('summary-max-loss').textContent =
          formData.maxAnnualLoss || '-';
        document.getElementById('summary-tolerance').textContent =
          formData.fluctuationTolerance || '-';
        document.getElementById('summary-goal').textContent =
          formData.investmentGoal || '-';
      }

      // Navigation functions
      function nextStep() {
        if (currentStep < totalSteps) {
          currentStep++;
          updateStepDisplay();
        }
      }

      function prevStep() {
        if (currentStep > 1) {
          currentStep--;
          updateStepDisplay();
        }
      }

      function goToStep(step) {
        if (step >= 1 && step <= totalSteps) {
          currentStep = step;
          updateStepDisplay();
        }
      }

      // Initialize on load
      document.addEventListener('DOMContentLoaded', init);
    </script>
  </body>
</html>
